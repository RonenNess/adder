(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.AdderScript=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var Errors=require("./../errors");var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Lexer=require("./lexer");var Parser=require("./parser");var defaultFlags=require("./default_flags");var Language=require("./../language");var Core=require("./../core");var Compiler=Class({constructor:function(flags){this._flags=flags||{};for(var key in defaultFlags){if(this._flags[key]===undefined){this._flags[key]=defaultFlags[key]}}this._spacesPerTab="";for(var i=0;i<this._flags.spacesNeededForBlockIndent;++i){this._spacesPerTab+=" "}this._lexer=new Lexer(this._flags)},compile:function(code,flags){flags=flags||{};if(flags.fixLineBreaks!==false){code=code.trim().replace(/\r\n/g,"\n").replace(/\r/g,"")}var tokens=this._lexer.parseExpression(code);var lastBlockIndent=0;var lineIndex=1;var ret=[];for(var i=0;i<tokens.length;++i){if(tokens[i].t==="_"){var currBlockIndent=tokens[i].v;if(currBlockIndent>lastBlockIndent){for(var k=currBlockIndent;k>lastBlockIndent;--k){ret.push(["NEW_BLOCK",lineIndex])}}else if(currBlockIndent<lastBlockIndent){for(var k=currBlockIndent;k<lastBlockIndent;++k){ret.push(["END_BLOCK",lineIndex])}}lastBlockIndent=currBlockIndent;continue}var j=i;var endToken=tokens[i];while(endToken&&endToken.t!=="b"){endToken=tokens[++j]}if(endToken&&endToken.v==="\n"){lineIndex++}var currTokens=tokens.slice(i,j);while(currTokens[currTokens.length-1]&&currTokens[currTokens.length-1].t==="b"){currTokens.pop()}i=j;if(currTokens.length===0)continue;var ast=Parser.parse(currTokens,lineIndex);if(ast&&ast!==[]){ret.push([ast,lineIndex])}}return ret}});module.exports=Compiler},{"./../core":13,"./../dependencies/jsface":23,"./../errors":27,"./../language":60,"./default_flags":2,"./lexer":4,"./parser":5}],2:[function(require,module,exports){"use strict";module.exports={spacesNeededForBlockIndent:4}},{}],3:[function(require,module,exports){module.exports=require("./compiler")},{"./compiler":1}],4:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Console=require("./../console");var signOperators=["+=","-=","*=","/=","|=","&=","%=","**","==","!=",">=","<=",">","<","+","-","*","/","|","&","%","=","."];var wordsOperators=["not in","is not","not","in","or","and","is"];var operators=signOperators.concat(wordsOperators);var defaultFlags=require("./default_flags");var commentPrefix="#";var Utils=require("./../utils");var breakingSigns=[" ","(",")","[","]",undefined,",",":",";","\n","\\"];breakingSigns=breakingSigns.concat(operators);breakingSigns=Utils.toSet(breakingSigns);var Lexer=Class({$static:{wordsOperators:wordsOperators,operators:operators},constructor:function(flags){this._flags=flags||defaultFlags},makeToken:function(type,val){return{t:type,v:val}},isBreaker:function(expression,pos){if(this.isComment(expression,pos)){return true}var c=expression[pos];return breakingSigns.has(c)},isNumber:function(c){return c>="0"&&c<="9"},isOpeningString:function(c){return c==='"'||c==="'"},isPunc:function(c){return c===","||c===":"},isComment:function(expression,start){return expression[start]===commentPrefix},readNumber:function(expression,start){var pos=start;var alreadyGotDot=false;while(expression[pos]==="."||!this.isBreaker(expression,pos)){var c=expression[pos];var isDot=c===".";if(!this.isNumber(c)&&!isDot){throw new Errors.IllegalExpression(expression,"Invalid syntax (non-digits inside a number)",this.lineIndex)}if(isDot){if(alreadyGotDot){throw new Errors.IllegalExpression(expression,"Invalid syntax (multiple decimal marks in float)",this.lineIndex)}alreadyGotDot=true}pos++}return[expression.substr(start,pos-start),pos-1]},readOperator:function(expression,start){var currSeg=expression.substr(start,10);for(var i=0;i<wordsOperators.length;++i){var currOp=wordsOperators[i];if(currSeg.indexOf(currOp+" ")===0){return[currOp,start+currOp.length-1]}}for(var i=0;i<signOperators.length;++i){var curr=signOperators[i];if(currSeg.substr(0,curr.length)===curr){return[curr,start+curr.length-1]}}return null},readString:function(expression,start){var quote=expression[start]==='"'?'"':"'";var i=start;var lastC;var c;while(c=expression[++i]){lastC=c;if(c===quote&&lastC!=="\\")break}if(c===undefined){throw new Errors.IllegalExpression(expression,"EOL while scanning string literal.",this.lineIndex)}var val=expression.substr(start,i-start+1);return[val,i]},readPunctuation:function(expression,start){return[expression[start],start]},readComment:function(expression,start){var pos=start;while(expression[pos]!==undefined&&expression[pos]!=="\n"){pos++}return["",pos]},readWord:function(expression,start){var pos=start;while(!this.isBreaker(expression,pos)){pos++}var word=expression.substr(start,pos-start);return[word,pos-1]},parseExpression:function(expression){var ret=[];var lastC;var c;this.lineIndex=1;var skipNextLineBreak=false;var lastBlockIndent=0;var wasLineBreak=false;var inlineBlocks=0;var spacesInRow=0;for(var i=0;i<expression.length;++i){if(expression[i]===" "){if(wasLineBreak)spacesInRow++;continue}if(expression[i]==="\t"){if(wasLineBreak)spacesInRow+=this._flags.spacesNeededForBlockIndent;continue}if(wasLineBreak){if(inlineBlocks>0){lastBlockIndent-=inlineBlocks;ret.push(this.makeToken("_",lastBlockIndent));inlineBlocks=0}else if(lastC!==";"){var spacesForIndent=this._flags.spacesNeededForBlockIndent;if(spacesInRow%spacesForIndent!==0){throw new Errors.SyntaxError("Bad block indent (spaces not multiply of "+this._flags.spacesNeededForBlockIndent+")",this.lineIndex)}var blockIndent=spacesInRow/spacesForIndent;if(blockIndent!==lastBlockIndent){ret.push(this.makeToken("_",blockIndent));lastBlockIndent=blockIndent}}spacesInRow=0}if(this.isComment(expression,i)){var tokenData=this.readComment(expression,i);i=tokenData[1];if(expression[i]){this.lineIndex++;wasLineBreak=true;ret.push(this.makeToken("b","\n"))}continue}lastC=c;var c=expression[i];if(c===";"||c==="\n"){this.lineIndex++;if(skipNextLineBreak){skipNextLineBreak=false}else{lastC=c;wasLineBreak=true;ret.push(this.makeToken("b",c))}continue}else if(c==="\\"){if(expression[i+1]!=="\n"){throw new Errors.SyntaxError("Invalid character after \\ sign.",this.lineIndex)}skipNextLineBreak=true;continue}if(lastC===":"){ret.push(this.makeToken("b",";"));lastBlockIndent++;ret.push(this.makeToken("_",lastBlockIndent));inlineBlocks++}wasLineBreak=false;if(c==="("||c===")"){ret.push(this.makeToken("o",c));continue}if(this.isPunc(c)){var tokenData=this.readPunctuation(expression,i);var token=tokenData[0];i=tokenData[1];ret.push(this.makeToken("p",token));continue}if(this.isNumber(c)){var tokenData=this.readNumber(expression,i);var token=tokenData[0];i=tokenData[1];ret.push(this.makeToken("n",token));continue}var tokenData=this.readOperator(expression,i);if(tokenData){var token=tokenData[0];i=tokenData[1];ret.push(this.makeToken("o",token));continue}if(this.isOpeningString(c)){var tokenData=this.readString(expression,i);var token=tokenData[0];i=tokenData[1];ret.push(this.makeToken("s",token));continue}var tokenData=this.readWord(expression,i);var token=tokenData[0];i=tokenData[1];if(token===""){throw new Errors.IllegalExpression(expression,"Invalid or unexpected token '"+c+"'!",this.lineIndex)}ret.push(this.makeToken("v",token))}Console.debug("Lexer parsed",ret);return ret}});module.exports=Lexer},{"./../console":6,"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./default_flags":2}],5:[function(require,module,exports){"use strict";var Errors=require("./../errors");var symbols={};var Utils=require("./../utils");var LanguageDefs=require("./../language/defs");var wordOperators=Utils.toSet(Object.keys(LanguageDefs.keywords));var gscope={i:0,tokens:[],line:undefined};var defineSymbol=function(id,nud,lbp,led){var sym=symbols[id]||{};symbols[id]={lbp:sym.lbp||lbp,nud:sym.nud||nud,led:sym.lef||led}};var defineInfix=function(id,lbp,rbp,led){rbp=rbp||lbp;defineSymbol(id,null,lbp,led||function(left){return{type:id,left:left,right:parseExpression(rbp)}})};var definePrefix=function(id,rbp){defineSymbol(id,function(){return{type:id,right:parseExpression(rbp)}})};defineSymbol(",");defineSymbol("blockopen",function(val){return val});defineSymbol("number",function(number){return number});defineSymbol("string",function(str){return str});defineSymbol("identifier",function(name){var token=currToken();if(token&&token.type==="("&&!wordOperators.has(name.value)){var args=[];if(gscope.tokens[gscope.i+1].v===")"){popToken()}else{do{popToken();if(!currToken()){throw new Errors.SyntaxError("Missing closing parenthesis ')'")}args.push(parseExpression(2))}while(currToken()&&currToken().type===",");if(!currToken()||currToken().type!==")"){throw new Errors.SyntaxError("Missing closing parenthesis ')'")}}popToken();return{type:"call",args:args,name:name.value}}return name});defineSymbol("(",function(){var value=parseExpression(2);if(currToken().type!==")")new Errors.SyntaxError("Missing closing parenthesis!");popToken();return value});defineSymbol(")");definePrefix("-",10);definePrefix("+",10);definePrefix("not",3);definePrefix("for",10);defineInfix("*",7);defineInfix("**",9,8);defineInfix("/",7);defineInfix("+",6);defineInfix("-",6);defineInfix("%",7);defineInfix("|",4,4);defineInfix("&",5,5);defineInfix("or",3);defineInfix("and",3);defineInfix("in",4);defineInfix("not in",4);defineInfix("is",4);defineInfix("is not",4);defineInfix("==",4);defineInfix("!=",4);defineInfix(">=",4);defineInfix("<=",4);defineInfix("<",4);defineInfix(">",4);defineInfix(".",13);defineInfix("=",1,2,function(left){if(left.type==="call"){for(var i=0;i<left.args.length;i++){if(left.args[i].type!=="identifier")throw new Errors.SyntaxError("Invalid argument name '"+left.args[i].value+"'!")}return{type:"function",name:left.name,args:left.args,value:parseExpression(2)}}else if(left.type==="identifier"){return{type:"assign",name:left.value,value:parseExpression(2)}}else throw new Errors.SyntaxError("Can't assign to literal!")});var assignmentWith=["+","-","*","/","|","&","%"];for(var i=0;i<assignmentWith.length;++i){(function(operator){defineInfix(operator+"=",1,2,function(left){if(left.type==="call"){for(var i=0;i<left.args.length;i++){if(left.args[i].type!=="identifier")throw new Errors.SyntaxError("Invalid argument name '"+left.args[i].value+"'!")}return{type:"function",name:left.name,args:left.args,value:parseExpression(2)}}else if(left.type==="identifier"){return{type:"assign+",op:operator,name:left.value,value:parseExpression(2)}}else throw new Errors.SyntaxError("Can't assign to literal!")})})(assignmentWith[i])}var tokenToSymbol=function(token){var type;switch(token.t){case"o":case"p":if(token.v===":"){type="blockopen"}else{type=token.v}break;case"n":type="number";break;case"v":type="identifier";break;case"s":type="string";break;default:throw new Errors.SyntaxError("Unknown token type '"+token.t+"'!")}var sym=Object.create(symbols[type]);sym.type=type;sym.value=token.v;return sym};var currToken=function(){return gscope.tokens[gscope.i]?tokenToSymbol(gscope.tokens[gscope.i]):null};var popToken=function(){var ret=currToken();gscope.i++;return ret};var parseExpression=function(rbp){if(rbp===undefined){rbp=0}var t=popToken();if(t===null){return}if(!t.nud){throw new Errors.SyntaxError("Unexpected token: "+t.type)}var left=t.nud(t);while(currToken()&&rbp<currToken().lbp){t=popToken();if(!t.led){throw new Errors.SyntaxError("Unexpected token: "+t.type)}left=t.led(left)}return left};function parse(tokens,line){gscope.tokens=tokens;gscope.i=0;gscope.line=line;try{var parseTree=[];while(currToken()){parseTree.push(parseExpression())}return parseTree}catch(e){if(e.expectedError){if(e.line===undefined){e.message+=" [at line: "+gscope.line+"]";e.line=gscope.line}throw e}throw new Errors.SyntaxError("Unknown syntax error!",gscope.line)}}module.exports={parse:parse}},{"./../errors":27,"./../language/defs":33,"./../utils":78}],6:[function(require,module,exports){"use strict";module.exports={log:function(){},debug:function(){},warn:function(){},info:function(){},bindToNativeConsole:function(){this.log=function(){console.log("AdderScript.log>",arguments)};this.debug=function(){console.debug("AdderScript.debug>",arguments)};this.warn=function(){console.warn("AdderScript.warn>",arguments)};this.info=function(){console.info("AdderScript.info>",arguments)}}}},{}],7:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Executable=require("./executable");var Block=Class(Executable,{constructor:function(context){Block.$super.call(this,context,null);this._executables=[]},execute:function(){var scope=this._context.getScope();var lastExecutable=null;for(var i=0;i<this._executables.length;++i){if(scope.calledReturn){break}else if(scope.calledContinue){break}var curr=this._executables[i];if(lastExecutable){if(lastExecutable.isBreakingBlock){return}if(lastExecutable.skipFollowingBlock&&curr.constructor===Block){continue}}this._context._interpreter.evalStatement(curr);lastExecutable=curr}},addStatement:function(statement){statement.setParentBlock(this,this._executables.length);this._executables.push(statement);this._lastStatement=statement},addBlock:function(block){var lastExecutable=this._executables[this._executables.length-1];if(lastExecutable===undefined){throw new Errors.SyntaxError("Unexpected new block indent!")}lastExecutable.setFollowingBlock(block);block.setParentBlock(this,this._executables.length);this._executables.push(block)},getChildren:function(){return this._executables},getDebugBlocksView:function(indent){indent=indent||1;var indentPrefix="";for(var i=0;i<indent;++i){indentPrefix+="    "}var ret="block:"+"\n";for(var i=0;i<this._executables.length;++i){var curr=this._executables[i];if(curr.type==="block"){ret+=indentPrefix+curr.getDebugBlocksView(indent+1)+"\n"}else{ret+=indentPrefix+curr.getRepr()+"\n"}}ret+=indentPrefix+"end_block"+"\n";return ret},type:"block"});module.exports=Block},{"./../dependencies/jsface":23,"./../errors":27,"./executable":11}],8:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var Utils=require("./../utils");var BuiltinFunction=Class({constructor:function(){},__imp:function(args){throw Errors.NotImplemented()},execute:function(args,obj){try{return this.__imp.apply(obj,args)}catch(e){if(e.expectedError){throw e}throw new Errors.InternalError("Exception in built-in function!",e)}},__isAdderObject:true,isFunction:true,isBuiltinFunc:true,deterministic:true,requiredArgs:0,optionalArgs:0,toString:function(){return"<"+this.identifier+">"},toRepr:function(){return this.toString()},$static:{create:function(func,mandatoryParams,optionalParams,deterministic){var type=Class(BuiltinFunction,{__imp:func,requiredArgs:mandatoryParams||null,optionalArgs:optionalParams||null,deterministic:deterministic===undefined?true:deterministic});return new type},getArgumentsOrListContent:function(context,args){if(args.length===1){if(args[0].type==="list"){return args[0]._value._list}else if(args[0].type==="set"){var ret=Utils.toArray(args[0]._value._set);return Variable.makeVariables(context,ret)}}return args}}});module.exports=BuiltinFunction},{"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./variable":21}],9:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Scope=require("./scope");var Utils=require("./../utils");var Variable=require("./variable");var Context=Class({constructor:function(interpreter,stackLimit,maxVarsInScope){this._interpreter=interpreter;this._globals=new Scope(this,0,null,maxVarsInScope);this._currScope=this._globals;this._stackLimit=stackLimit;this._maxVarsPerScope=maxVarsInScope;this._readonly=new Set;this._stack=[];this.stackPush()},getCurrBlockType:function(){return this._currScope._type},clearStack:function(){while(this._stack.length>1){this.stackPop()}},reset:function(){this.clearStack();for(var key in this._globals._vars){if(!this._readonly.has(key)){this._globals.remove(key)}}},stackPush:function(type){var scope=this._stack.length===0?this._globals:new Scope(this,this._stack.length,type,this._maxVarsPerScope);this._stack.push({scope:scope,breakAccess:type==="function"});if(this._stack.length>this._stackLimit){throw new Errors.StackOverflow(this._stackLimit)}this._currScope=this._stack[this._stack.length-1].scope},stackPop:function(){var thisScope=this._currScope;var parentScope=this._globals;if(this._stack.length>1&&!this._stack[this._stack.length-1].breakAccess){parentScope=this._stack[this._stack.length-2].scope;for(var key in thisScope._vars){parentScope.setVar(key,thisScope._vars[key])}}parentScope.returnValue=thisScope.returnValue;for(var key in thisScope._vars){if(this._globals._vars[key]!==undefined){this._globals.setVar(key,thisScope._vars[key])}}this._stack.pop();if(this._stack.length===0){throw new Errors.RuntimeError("Invalid return statements at global block!")}this._currScope=this._stack[this._stack.length-1].scope},remove:function(varName){if(this._readonly.has(varName)){throw new Errors.RuntimeError("Cannot delete readonly variable '"+varName+"'!")}var scopes=this._getSharedScopes();for(var i=0;i<scopes.length;++i){scopes[i].remove(varName)}},_getSharedScopes:function(){var ret=[this.getScope()];for(var i=this._stack.length-2;i>0;--i){var curr=this._stack[i];ret.push(curr.scope);if(curr.breakAccess){break}}if(this._stack.length>0){ret.push(this._globals)}return ret},getScope:function(){return this._currScope},getVar:function(key,object){if(object!==undefined){if(!object.__isAdderObject){object=Variable.makeAdderObjects(this,object);if(!object.isSimple){object=object._value}}var resultObj=object&&object.api?object.api[key]:undefined;if(resultObj===undefined){throw new Errors.RuntimeError("Object '"+(object.name||object.type||object.identifier||typeof object)+"' has no attribute '"+key+"'.")}return resultObj}var val;for(var i=this._stack.length-1;i>0&&val===undefined;--i){val=this._stack[i].scope.getVar(key,object);if(this._stack[i].breakAccess){break}}if(val===undefined){val=this._globals.getVar(key,object)}if(val===undefined){throw new Errors.UndefinedVariable(key)}return val},exist:function(key,object){var val=this.getScope().getVar(key,object);if(val===undefined){val=this._globals.getVar(key,object)}return val!==undefined},setVar:function(key,val,readonly,force){if(readonly&&this._stack.length>1){throw new Errors.RuntimeError("Cannot set readonly variable outside global scope. Variable key: '"+key+"'.")}if(this._readonly.has(key)&&!force){throw new Errors.RuntimeError("Trying to override readonly variable or reserved word: '"+key+"'.")}if(readonly){this._readonly.add(key)}return this.getScope().setVar(key,val,readonly,force)},createVariable:function(val,forceNew){return Variable.makeVariables(this,val,forceNew)},getAllIdentifiers:function(){var scopes=this._getSharedScopes();var ret=[];for(var i=0;i<scopes.length;++i){ret=ret.concat(scopes[i].getAllIdentifiers())}ret=Utils.toArray(Utils.toSet(ret));return ret}});module.exports=Context},{"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./scope":17,"./variable":21}],10:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var BuiltinFunc=require("./builtin_func");var Utils=require("./../utils");var _Object=require("./object");var List=require("./list");function validate_len(dict){if(Object.keys(dict._dict).length>dict._context._interpreter._flags.maxContainersLen){throw new Errors.ExceedMemoryLimit("Dictionary exceeded maximum container length ("+dict._context._interpreter._flags.maxContainersLen+")")}}var apiFuncs={clone:function(){var ret=new Dict(this._context);for(var key in this._dict){ret.set(Variable.makeVariables(this._context,key),this._dict[key])}return ret},keys:function(){return new List(this._context,Object.keys(this._dict))},values:function(){var ret=[];for(var key in this._dict){ret.push(this._dict[key])}return ret},len:function(){return Object.keys(this._dict).length},empty:function(){return this.len()===0},set:function(key,value){if(!key.isSimple){throw new Errors.RuntimeError("Invalid key type '"+key.type+"'. Dictionary keys can only be strings, numbers, booleans or none.")}this._dict[key._value]=value;validate_len(this);this._context._interpreter.updateMemoryUsage(value._estimatedSize+key.length)},get:function(key,defaultVal){return this._dict[key._value]||defaultVal},remove:function(key){delete this._dict[key._value]},clear:function(){this._dict={}},has:function(key){return this._dict[key._value]!==undefined},extend:function(other){if(other.type!=="dict"){throw new Errors.RuntimeError("Dict 'extend()' expecting another dictionary as param ('"+other.type+"' given).")}other=other._value;for(var key in other._dict){this._dict[key]=other._dict[key]}}};var Dict=Class(_Object,{constructor:function(context,startingDict){Dict.$super.call(this,context);this._dict=startingDict||{}},forEach:function(callback,obj){for(var key in this._dict){if(callback.call(obj,key)===false){return}}},api:{clone:BuiltinFunc.create(apiFuncs.clone,0,0,false),keys:BuiltinFunc.create(apiFuncs.keys,0,0,false),values:BuiltinFunc.create(apiFuncs.values,0,0,false),len:BuiltinFunc.create(apiFuncs.len,0,0,false),_set:BuiltinFunc.create(apiFuncs.set,2,0,false),_get:BuiltinFunc.create(apiFuncs.get,1,1,false),remove:BuiltinFunc.create(apiFuncs.remove,1,0,false),clear:BuiltinFunc.create(apiFuncs.clear,0,0,false),empty:BuiltinFunc.create(apiFuncs.empty,0,0,false),has:BuiltinFunc.create(apiFuncs.has,1,0,false),extend:BuiltinFunc.create(apiFuncs.extend,1,0,false)},toString:function(){var ret=[];for(var key in this._dict){ret.push('"'+key+'": '+this._dict[key].toString())}return ret.join(",")},toRepr:function(){return"dict("+this.toString()+")"},toNativeJs:function(){var ret={};for(var key in this._dict){ret[key]=this._dict[key].toNativeJs()}return ret},name:"dict",type:"dict"});_Object.initBuiltinApi(Dict);module.exports=Dict},{"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./builtin_func":8,"./list":14,"./object":16,"./variable":21}],11:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Executable=Class({constructor:function(context){this._context=context;this._parentBlock=null;this._followingBlock=null;this._position=-1},execute:function(){throw new Errors.NotImplemented},setParentBlock:function(block,position){this._parentBlock=block;this._position=position},setFollowingBlock:function(block){this._followingBlock=block},type:"executable"});module.exports=Executable},{"./../dependencies/jsface":23}],12:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var Lexer=require("./../compiler/lexer");function setNodeOptimizedVal(node,val){node.type=typeof val;node.value=val;node.wasOptimized=true;delete node.left;delete node.right}var opFuncs={"*":function(exp,a,b){return a*b},"/":function(exp,a,b){return a/b},"+":function(exp,a,b){return b===undefined?+a:a+b},"-":function(exp,a,b){return b===undefined?-a:a-b},"|":function(exp,a,b){return a|b},"&":function(exp,a,b){return a&b},"%":function(exp,a,b){return a%b},or:function(exp,a,b){return a||b},and:function(exp,a,b){return a&&b},in:function(exp,a,b){a=Variable.makeVariables(exp._context,a);b=Variable.makeAdderObjects(exp._context,b);if(!b.has){throw new Errors.RuntimeError(exp._context,"Object "+(b.type||"undefined")+" does not support 'in' operator!")}return b.has(a)},"not in":function(exp,a,b){a=Variable.makeVariables(exp._context,a);b=Variable.makeAdderObjects(exp._context,b);if(!b.has){throw new Errors.RuntimeError(exp._context,"Object "+(b.type||"undefined")+" does not support 'in' operator!")}return!b.has(a)},not:function(exp,a){return!a},"**":function(exp,a,b){return Math.pow(a,b)},"<":function(exp,a,b){return a<b},">":function(exp,a,b){return a>b},"<=":function(exp,a,b){return a<=b},">=":function(exp,a,b){return a>=b},"==":function(exp,a,b){a=Variable.makeVariables(exp._context,a);b=Variable.makeVariables(exp._context,b);return Variable.equal(a,b)},is:function(exp,a,b){return a===b},"is not":function(exp,a,b){return a!==b},"!=":function(exp,a,b){a=Variable.makeVariables(exp._context,a);b=Variable.makeVariables(exp._context,b);return!Variable.equal(a,b)}};var Expression=Class({constructor:function(context,ast){this._context=context;this._ast=ast},parseNode:function(node,currObj,returnAsVar){if(node===undefined){throw new Errors.SyntaxError("Unexpected EOL or missing argument!")}switch(node.type){case".":var leftObj=this.parseNode(node.left);return this.parseNode(node.right,leftObj);break;case"number":return parseFloat(node.value);case"boolean":return node.value;case"object":return node.value;case"string":var ret=String(node.value);if(ret[0]==='"'||ret[0]==="'"){ret=ret.substr(1,ret.length-2)}return ret;case"identifier":var value=this._context.getVar(node.value,currObj);if(!returnAsVar){var readonly=true;if(value._value!==undefined){readonly=value._scopeData.readonly;value=value._value}if(readonly){setNodeOptimizedVal(node,value)}}return value;case"assign":return this._context.setVar(node.name,this.parseNode(node.value));case"assign+":var opFunc=opFuncs[node.op];if(!opFunc){throw new Errors.SyntaxError("Unknown operator '"+node.op+"='.")}var _var=this._context.getVar(node.name,currObj);var a=_var._value;var b=this.parseNode(node.value);if(b&&b._value!==undefined){b=b._value}var result=opFunc(this,a,b);return(_var._scopeData.scope||this._context).setVar(node.name,result);case"call":var func=this._context.getVar(node.name,currObj);var args=[];var isAllSimple=true;for(var i=0;i<node.args.length;i++){var arg=this.parseNode(node.args[i],undefined,true);args.push(arg);if(arg&&typeof arg==="object"&&!arg.wasOptimized){isAllSimple=false}}var ret=this._context._interpreter.callFunction(func,args,currObj);if(func.deterministic&&typeof ret!=="object"&&isAllSimple){setNodeOptimizedVal(node,ret)}return ret;default:if(opFuncs[node.type]){var opFunc=opFuncs[node.type];var ret;if(node.left){var l=this.parseNode(node.left);var r=this.parseNode(node.right);if(l&&l._value!==undefined){l=l._value}if(r&&r._value!==undefined){r=r._value}ret=opFunc(this,l,r)}else{var r=this.parseNode(node.right);if(r&&r._value!==undefined){r=r._value}return opFunc(this,r)}if(node.wasOptimized===undefined){if((!node.left||node.left.type==="string"||node.left.type==="number")&&(node.right.type==="string"||node.right.type==="number")){setNodeOptimizedVal(node,ret)}else{node.wasOptimized=false}}return ret}return node}},eval:function(){return this.parseNode(this._ast)}});module.exports=Expression},{"./../compiler/lexer":4,"./../dependencies/jsface":23,"./../errors":27,"./variable":21}],13:[function(require,module,exports){"use strict";var core={Statement:require("./statement"),Expression:require("./expression"),Scope:require("./scope"),Object:require("./object"),Context:require("./context"),Block:require("./block"),Variable:require("./variable"),BuiltinFunc:require("./builtin_func"),List:require("./list"),Set:require("./set"),Dict:require("./dict"),Module:require("./module")};for(var key in core){core[key].prototype.identifier="core."+key}module.exports=core},{"./block":7,"./builtin_func":8,"./context":9,"./dict":10,"./expression":12,"./list":14,"./module":15,"./object":16,"./scope":17,"./set":18,"./statement":19,"./variable":21}],14:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var _Object=require("./object");var Variable=require("./variable");var BuiltinFunc=require("./builtin_func");function validate_len(list){if(list._list.length>list._context._interpreter._flags.maxContainersLen){throw new Errors.ExceedMemoryLimit("List exceeded maximum container length ("+list._context._interpreter._flags.maxContainersLen+")")}}var apiFuncs={clone:function(){return new List(this._context,this._list)},empty:function(){return this._list.length===0},to_set:function(){return new _Set(this._context,this._list)},len:function(){return this._list.length},append:function(item){this._list.push(item);validate_len(this);this._context._interpreter.updateMemoryUsage(item._estimatedSize);return this},has:function(item){return this.index(item)!==-1},clear:function(){this._list=[]},count:function(item){var ret=0;for(var i=0;i<this._list.length;++i){if(Variable.equal(this._list[i],item)){ret++}}return ret},extend:function(other){if(other.type!=="list"){throw new Errors.RuntimeError("List 'extend()' expecting another list as param ('"+other.type+"' given).")}this._list=this._list.concat(other._value._list);validate_len(this);return this},index:function(item){for(var i=0;i<this._list.length;++i){if(Variable.equal(this._list[i],item)){return i}}return-1},insert:function(item,position){this._list.splice(position,0,item);validate_len(this);return item},join:function(str){var connector=(str?str._value:str)||undefined;return this._list.map(function(x){return x._value}).join(connector)},pop:function(index){var ret;if(index===undefined){ret=this._list.pop()}else{ret=this._list.splice(index,1)[0]}if(ret===undefined){return new Variable(this._context,null)}return ret},shift:function(){return this._list.shift()||new Variable(this._context,null)},remove:function(item){var index=this.index(item);if(index!==-1){this._list.splice(index,1);return true}return false},reverse:function(){this._list.reverse()},slice:function(start,end){var sub=this._list.slice(start,end);return new List(this._context,sub)},sort:function(){this._list.sort()},at:function(index){if(index.type!=="number"){throw new Errors.RuntimeError("List 'at()' must receive a number as param (got '"+index.type+"' instead).")}index=Math.round(index._value);if(index<0){index=this._list.length+index}if(index>=this._list.length){throw new Errors.RuntimeError("Index out of list range!")}return this._list[index]}};var List=Class(_Object,{constructor:function(context,args){List.$super.call(this,context);args=Variable.makeVariables(context,args);this._list=args?args.slice(0):[];validate_len(this)},forEach:function(callback,obj){for(var i=0;i<this._list.length;++i){if(callback.call(obj,this._list[i])===false){return}}},api:{clone:BuiltinFunc.create(apiFuncs.clone,0,0,false),empty:BuiltinFunc.create(apiFuncs.empty,0,0,false),to_set:BuiltinFunc.create(apiFuncs.to_set,0,0,false),len:BuiltinFunc.create(apiFuncs.len,0,0,false),shift:BuiltinFunc.create(apiFuncs.shift,0,0,false),append:BuiltinFunc.create(apiFuncs.append,1,0,false),has:BuiltinFunc.create(apiFuncs.has,1,0,false),clear:BuiltinFunc.create(apiFuncs.clear,0,0,false),count:BuiltinFunc.create(apiFuncs.count,1,0,false),extend:BuiltinFunc.create(apiFuncs.extend,1,0,false),index:BuiltinFunc.create(apiFuncs.index,1,0,false),insert:BuiltinFunc.create(apiFuncs.insert,2,0,false),pop:BuiltinFunc.create(apiFuncs.pop,0,1,false),remove:BuiltinFunc.create(apiFuncs.remove,1,0,false),reverse:BuiltinFunc.create(apiFuncs.reverse,0,0,false),slice:BuiltinFunc.create(apiFuncs.slice,1,1,false),join:BuiltinFunc.create(apiFuncs.join,0,1,false),sort:BuiltinFunc.create(apiFuncs.sort,0,0,false),at:BuiltinFunc.create(apiFuncs.at,1,0,false)},toString:function(){var params=this._list.map(function(x){return x.toString()});return params.join(",")},toRepr:function(){return"list("+this.toString()+")"},toNativeJs:function(){var ret=[];for(var i=0;i<this._list.length;++i){ret.push(this._list[i].toNativeJs())}return ret},name:"list",type:"list"});_Object.initBuiltinApi(List);module.exports=List;var _Set=require("./set")},{"./../dependencies/jsface":23,"./../errors":27,"./builtin_func":8,"./object":16,"./set":18,"./variable":21}],15:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var _Object=require("./object");var Module=Class(_Object,{constructor:function(context,identifier){this.identifier=identifier||this.identifier;Module.$super.call(this,context);if(!this.__proto__._wasInit){this.__proto__._wasInit=true;for(var key in this.api){var curr=this.api[key];if(curr&&curr.identifier){curr.identifier=this.identifier+"."+key}}}},isSafe:false,name:"module",type:"module",version:"1.0.0"});module.exports=Module},{"./../dependencies/jsface":23,"./../errors":27,"./object":16}],16:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var Utils=require("./../utils");var BuiltinFunc=require("./builtin_func");var _Object=Class({constructor:function(context){this._context=context},setAttr:function(key,value){if(value.constructor!==Variable){value=new Variable(this._context,value)}this.api[key]=value},toNativeJs:function(){return this.toString()},toRepr:function(){return this.toString()},getAttr:function(key){return this.api[key]},api:{},_objectApi:{str:BuiltinFunc.create(function(){return this.toString?this.toString():this.type},0,0)},name:"object",type:"object",__isAdderObject:true,toString:function(){return"<"+this.identifier+">"},$static:{initBuiltinApi:function(obj){obj=obj.prototype;for(var key in obj._objectApi){if(obj.api[key]===undefined){obj.api[key]=obj._objectApi[key]}}if(obj.api._get){obj.api.get=obj.api._get;delete obj.api._get}if(obj.api._set){obj.api.set=obj.api._set;delete obj.api._set}for(var key in obj.api){var curr=obj.api[key];if(curr.isBuiltinFunc){(function(key){obj[key]=function(){return this.api[key].execute.call(this.api[key],arguments,this)}})(key)}}}}});module.exports=_Object},{"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./builtin_func":8,"./variable":21}],17:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var Console=require("./../console");var Scope=Class({constructor:function(context,depth,type,maxVars){this._context=context;this._type=type||"block";this._maxVars=maxVars||1e5;this._vars={};this._varKeys=new Set;this._readonly={};this._depth=depth;this.calledReturn=false;this.returnValue=null;this.calledContinue=false;this.calledBreak=false},setVar:function(key,val,readonly,force){val=Variable.makeAdderObjects(this._context,val,true);val.setScopeData(this,key,readonly);if(!force){this._context._interpreter.updateMemoryUsage(val._estimatedSize)}this._vars[key]=val;this._varKeys.add(key);if(!force&&this._varKeys.size>this._maxVars){throw new Errors.ExceedMemoryLimit("Exceeded scope size limit of "+this._maxVars+" variables!")}return val},remove:function(key){delete this._vars[key];this._varKeys.delete(key)},getVar:function(key,object){return this._vars[key]},getAllIdentifiers:function(){return Object.keys(this._vars)}});module.exports=Scope},{"./../console":6,"./../dependencies/jsface":23,"./../errors":27,"./variable":21}],18:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Variable=require("./variable");var BuiltinFunc=require("./builtin_func");var Utils=require("./../utils");var _Object=require("./object");function validate_len(set){if(set._set.size>set._context._interpreter._flags.maxContainersLen){throw new Errors.ExceedMemoryLimit("Set exceeded maximum container length ("+set._context._interpreter._flags.maxContainersLen+")")}}var apiFuncs={clone:function(){return new _Set(this._context,Utils.toArray(this._set))},to_list:function(){var setAsList=Utils.toArray(this._set);return new List(this._context,setAsList)},len:function(){return this._set.size},join:function(str){return this.to_list().join(str)},empty:function(){return this._set.size===0},add:function(item){item=item._value;if(item&&typeof item==="object"){throw new Errors.RuntimeError("Cannot add objects to set(), only simple types (bool, string, number, or none).")}this._context._interpreter.updateMemoryUsage(item?item.length||4:1);this._set.add(item);validate_len(this);return this},clear:function(){this._set=new Set},has:function(item){return this._set.has(item._value)},extend:function(other){if(other.type!=="set"){throw new Errors.RuntimeError("Set 'extend()' expecting another set as param ('"+other.type+"' given).")}var _this=this;other._value._set.forEach(function(x){_this._set.add(x)});validate_len(this)},index:function(item){item=item._value;var BreakException={};var i=0;var ret=-1;try{this._set.forEach(function(x){if(x===item){ret=i;throw BreakException}i++})}catch(e){if(e!==BreakException)throw e}return ret},remove:function(item){return this._set.delete(item._value)}};var _Set=Class(_Object,{constructor:function(context,args){_Set.$super.call(this,context);this._set=new Set;for(var i=0;i<args.length;++i){var curr=args[i];this.add(curr)}},forEach:function(callback,obj){this._set.forEach(function(x){callback.call(obj,x)})},api:{clone:BuiltinFunc.create(apiFuncs.clone,0,0,false),to_list:BuiltinFunc.create(apiFuncs.to_list,0,0,false),len:BuiltinFunc.create(apiFuncs.len,0,0,false),add:BuiltinFunc.create(apiFuncs.add,1,0,false),clear:BuiltinFunc.create(apiFuncs.clear,0,0,false),empty:BuiltinFunc.create(apiFuncs.empty,0,0,false),has:BuiltinFunc.create(apiFuncs.has,1,0,false),extend:BuiltinFunc.create(apiFuncs.extend,1,0,false),index:BuiltinFunc.create(apiFuncs.index,1,0,false),remove:BuiltinFunc.create(apiFuncs.remove,1,0,false),join:BuiltinFunc.create(apiFuncs.join,0,1,false)},toString:function(){var params=Utils.toArray(this._set).map(function(x){return x.toString()});return params.join(",")},toRepr:function(){return"set("+this.toString()+")"},toNativeJs:function(){var ret=new Set;this._set.forEach(function(x){ret.add(x)});return ret},name:"set",type:"set"});_Object.initBuiltinApi(_Set);module.exports=_Set;var List=require("./list")},{"./../dependencies/jsface":23,"./../errors":27,"./../utils":78,"./builtin_func":8,"./list":14,"./object":16,"./variable":21}],19:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var Executable=require("./executable");var Statement=Class(Executable,{constructor:function(context,line){Statement.$super.call(this,context);this._line=line},$static:{getKeyword:function(){return null}},setPreviousStatement:function(statement){},getRepr:function(){return this.constructor.getKeyword()},openNewBlock:false,skipFollowingBlock:false,isBreakingBlock:false,type:"statement"});module.exports=Statement},{"./../dependencies/jsface":23,"./../errors":27,"./executable":11}],20:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var BuiltinFunc=require("./builtin_func");var api={};api.len=BuiltinFunc.create(function(){return this.length},0,0,false);api.split=BuiltinFunc.create(function(delimiter){delimiter=delimiter?delimiter._value:" ";return this.split(delimiter)},0,1,false);api.replace=BuiltinFunc.create(function(find,replace){find=find._value;replace=replace?replace._value:replace;return this.split(find).join(replace)},2,0,false);api.remove=BuiltinFunc.create(function(word){word=word._value;return this.split(word).join("")},1,0,false);api.index=BuiltinFunc.create(function(find){find=find._value;return this.indexOf(find)},1,0,false);api.has=BuiltinFunc.create(function(find){find=find._value;return this.indexOf(find)!==-1},1,0,false);api.count=BuiltinFunc.create(function(word){return this.split(word).length-1},1,1,false);api.trim=BuiltinFunc.create(function(){return this.trim()},0,0,false);api.hash=BuiltinFunc.create(function(){var hash=0,i,chr,len;if(this.length===0)return hash;for(i=0,len=this.length;i<len;i++){chr=this.charCodeAt(i);hash=(hash<<5)-hash+chr;hash|=0}return hash},0,0,false);api.ends_with=BuiltinFunc.create(function(word){word=word._value;return this.indexOf(word)===this.length-word.length},1,0,false);api.starts_with=BuiltinFunc.create(function(word){word=word._value;return this.indexOf(word)===0},1,0,false);api.is_alpha=BuiltinFunc.create(function(){return/^[a-zA-Z()]+$/.test(this)},0,0,false);api.is_digit=BuiltinFunc.create(function(){return/^\d+$/.test(this)},0,0,false);api.lower=BuiltinFunc.create(function(){return this.toLowerCase()},0,0,false);api.upper=BuiltinFunc.create(function(){return this.toUpperCase()},0,0,false);api.title=BuiltinFunc.create(function(){return this.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})},0,0,false);api.slice=BuiltinFunc.create(function(start,len){start=start._value;len=len?len._value:len;return this.substr(start,len)},1,1,false);module.exports=api},{"./../dependencies/jsface":23,"./../errors":27,"./builtin_func":8}],21:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../errors");var LanguageDefs=require("./../language/defs");var Utils=require("./../utils");var simpleTypes=Utils.toSet(["string","number","boolean","none"]);var Variable=Class({constructor:function(context,value){this._context=context;if(value===null||value===undefined){value=null;this.type="none";this.isSimple=true;this._estimatedSize=1}else{if(value.isFunction){this.type="function";this.isSimple=false;this._estimatedSize=4}else if(typeof value==="number"&&isNaN(value)){this.type="NaN";this.isSimple=false;this._estimatedSize=4}else if(value.type){this.type=value.type;this.isSimple=false;this._estimatedSize=4}else{this.type=typeof value;if(this.type==="string"){var maxLen=this._context._interpreter._flags.maxStringLen;if(maxLen&&value.length>maxLen){throw new Errors.ExceedMemoryLimit("String exceeded length limit of "+maxLen+"!")}this._estimatedSize=value.length}else{this._estimatedSize=1}this.isSimple=true}}this.api=APIs[this.type];this._scopeData={};this._value=value},setScopeData:function(scope,name,readonly){this._scopeData={scope:scope,name:name,readonly:readonly}},$static:{isVariable:function(val){return val&&val.constructor===Variable},equal:function(a,b){if(a===b){return true}var typeA=a.type;var typeB=b.type;if(typeA!==typeB){return false}a=a._value;b=b._value;switch(typeA){case"NaN":return true;case"list":if(a.len()!==b.len()){return false}for(var i=0;i<a._list.length;++i){if(!Variable.equal(a._list[i],b._list[i])){return false}}return true;case"dict":var ak=a.keys();var bk=b.keys();if(ak.len()!==bk.len()){return false}for(var i=0;i<ak._list.length;++i){var key=ak._list[i]._value;if(!Variable.equal(a._dict[key],b._dict[key])){return false}}return true;case"set":if(a.len()!==b.len()){return false}a=a.to_list();b=b.to_list();for(var i=0;i<a._list.length;++i){if(!Variable.equal(a._list[i],b._list[i])){return false}}return true;default:return a===b}},is:function(a,b){if(a===b){return true}var typeA=a.type;var typeB=b.type;if(typeA!==typeB){return false}a=a._value;b=b._value;if(typeA==="NaN"){return true}if(a&&a.api){return a===b}return a===b},makeVariables:function(context,val,forceCreateNew){if(val instanceof Array){if(val.length===0){return val}for(var i=0;i<val.length;++i){val[i]=Variable.makeVariables(context,val[i],forceCreateNew)}return val}if(val&&val.constructor===Variable){if(forceCreateNew){return new Variable(context,val._value)}return val}return new Variable(context,val)},makeAdderObjects:function(context,val,forceCreateNew){if(val&&val.constructor===Variable){if(forceCreateNew){return new Variable(context,val._value)}return val}else if(val instanceof Array){for(var i=0;i<val.length;++i){val[i]=Variable.makeAdderObjects(context,val[i],forceCreateNew)}val=new _List(context,val)}else if(val&&val.constructor===Set){val=new _Set(context,Utils.toArray(val))}else if(val instanceof Object&&!val.__isAdderObject){for(var key in val){val[key]=Variable.makeAdderObjects(context,val[key],forceCreateNew)}val=new _Dict(context,val)}return new Variable(context,val)}},getValue:function(){return this._value},getType:function(){return this.type},deleteSelf:function(){if(!this._scopeData.scope){throw new Errors.RuntimeError("Cannot delete object '"+this.toString()+"'!")}this._context.remove(this._scopeData.name);this._scopeData={}},has:function(val){if(this._value===null||this._value===undefined){return false}if(this._value.has){return this._value.has(val)}if(val&&val.getValue){val=val._value}return String(this._value).indexOf(val)!==-1},toNativeJs:function(){var val=this._value;if(!val){return val}if(val.toNativeJs){return val.toNativeJs()}if(val.isFunction){return val.func||val.__imp}return val},toRepr:function(){var val=this._value;switch(this.type){case"string":return'"'+val+'"';case"number":return String(val);case"none":return LanguageDefs.keywords["null"];case"boolean":return LanguageDefs.keywords[String(val)];case"function":return val.toRepr();default:if(val&&val.toRepr){return val.toRepr()}return String(val)}},toString:function(){switch(this.type){case"string":return this._value;case"number":return String(this._value);case"none":return"";case"boolean":return LanguageDefs.keywords[String(this._value)];case"function":return this._value.toString();default:if(this._value&&this._value.toString){return this._value.toString()}return String(this._value)}}});module.exports=Variable;var _List=require("./list");var _Set=require("./set");var _Dict=require("./dict");var APIs={string:require("./string_api")}},{"./../dependencies/jsface":23,"./../errors":27,"./../language/defs":33,"./../utils":78,"./dict":10,"./list":14,"./set":18,"./string_api":20}],22:[function(require,module,exports){"use strict";module.exports={version:"1.0.1",about:"AdderScript is a lightweight minimalistic script language, aimed to execute untrusted code in a safe way.\nDesigned and built by Ronen Ness",author:"Ronen Ness"}},{}],23:[function(require,module,exports){"use strict";!function(t,o,r,e,n,p,i,c,u,f){function s(t){return t&&typeof t===o&&!(typeof t.length===r&&!t.propertyIsEnumerable(e))&&t||null}function l(t){return t&&typeof t===o&&typeof t.length===r&&!t.propertyIsEnumerable(e)&&t||null}function y(t){return t&&"function"==typeof t&&t||null}function a(t){return y(t)&&t.prototype&&t===t.prototype.constructor&&t||null}function $(t,o,r,e){r&&r.hasOwnProperty(t)||(e[t]=o)}function b(t,o,r){if(l(o))for(var e=o.length;--e>=0;)b(t,o[e],r);else{r=r||{constructor:1,$super:1,prototype:1,$superp:1};var n,p,i=a(t),c=a(o),u=t.prototype;if(s(o)||i)for(n in o)$(n,o[n],r,t,i,u);if(c){p=o.prototype;for(n in p)$(n,p[n],r,t,i,u)}i&&c&&b(u,o.prototype,r)}}function g(t){var o,r;Object.freeze(t);for(r in t)o=t[r],t.hasOwnProperty(r)&&"object"==typeof o&&!Object.isFrozen(o)&&g(o)}function O(t,o){o||(o=t,t=0);var r,e,n,p,i,c,u,f,s,l,y,a=0,$={constructor:1,$singleton:1,$static:1,$statics:1,prototype:1,$super:1,$superp:1,main:1,toString:0},b=O.plugins;o=("function"==typeof o?o():o)||{},e=o.hasOwnProperty("constructor")?o.constructor:null,n=o.$singleton,p=o.$statics||o.$static;for(i in b)$[i]=1;for(t=!t||t instanceof Array?t:[t],u=t&&t.length,s=t[0],r=n?function(){}:e?e:function(){s&&s.apply(this,arguments)},!n&&u&&(l=s.prototype&&s===s.prototype.constructor&&s,l?(y=function(){},y.prototype=l.prototype,y.prototype.constructor=y,r.prototype=new y,r.prototype.constructor=r,l.prototype.constructor=l):r.prototype=s),c=n?r:r.prototype;u>a;){f=t[a++];for(i in f)$[i]||(r[i]=f[i]);if(!n&&0!==a)for(i in f.prototype)$[i]||(c[i]=f.prototype[i])}for(i in o)if(!$[i]){var g=o[i];g&&(g.get||g.set)?(g.enumerable=!0,Object.defineProperty(c,i,g)):c[i]=g}for(i in p)r[i]=p[i];f=t&&s||t,r.$super=f,r.$superp=f&&f.prototype||f;for(i in b)b[i](r,t,o);return"function"==typeof o.main&&o.main.call(r,r),r}O.plugins={$ready:function h(t,o,r,e){for(var n,c,u,f=r.$ready,s=o?o.length:0,l=s,a=s&&o[0].$super;s--;)for(c=0;i>c&&(u=p[c],n=o[s],n===u[0]&&(u[1].call(n,t,o,r),l--),l);c++);a&&h(t,[a],r,!0),!e&&y(f)&&(f.call(t,t,o,r),p.push([t,f]),i++)},$const:function(t,o,r){var e,n=r.$const;for(e in n)Object.defineProperty(t,e,{enumerable:!0,value:n[e]}),"object"!=typeof t[e]||Object.isFrozen(t[e])||g(t[e])}},f={Class:O,extend:b,mapOrNil:s,arrayOrNil:l,functionOrNil:y,classOrNil:a},"undefined"!=typeof module&&module.exports?module.exports=f:(u=t.Class,t.Class=O,t.jsface=f,f.noConflict=function(){t.Class=u})}(this,"object","number","length",Object.prototype.toString,[],0)},{}],24:[function(require,module,exports){"use strict";var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Console=require("./../console");var Program=require("./program");var Compiler=require("./../compiler");var Core=require("./../core");var Errors=require("./../errors");var Utils=require("./../utils");var Language=require("./../language");var Environment=Class({$singleton:true,Errors:Errors,Utils:Utils,init:function(params){params=params||{};this._flags=params.flags||{};this._modules=params.modules||["SAFE"];this._outputFunc=params.outputFunc||null;this._customModules={};if(params.showDebugConsole){Console.bindToNativeConsole()}Console.info("Created a new environment!",this._flags,this._modules);this._compiler=new Compiler(this._flags)},compile:function(code){return this._compiler.compile(code)},newProgram:function(compiledCode){var program=new Program(compiledCode,this._modules,this._flags,this._outputFunc);for(var key in this._customModules){program.addModule(key,this._customModules[key])}return program},__toBuiltin:function(data,key,containerName){if(typeof data==="object"&&data.func){data=Core.BuiltinFunc.create(data.func,data.requiredParams,data.optionalParams,data.deterministic||false);data.identifier=containerName+".functions."+key;data.convertParamsToNativeJs=true;return data}return data},addBuiltinFunction:function(data){Language.Builtins.Functions[data.name]=this.__toBuiltin(data,data.name,"custom.builtin")},removeBuiltinFunction:function(name){delete Language.Builtins.Functions[name]},addBuiltinModule:function(name,moduleApi){for(var key in moduleApi){var curr=moduleApi[key];curr=this.__toBuiltin(curr,key,name);moduleApi[key]=curr}var CustomModule=Class(Core.Module,{api:moduleApi,name:name,version:"1.0.0"});this._customModules[name]=CustomModule},removeBuiltinModule:function(name){delete this._customModules[name]},defineBuiltinObject:function(name,api){for(var key in api){var curr=api[key];curr=this.__toBuiltin(curr,key,name);api[key]=curr}var ret=function(){var _ObjType=Class(Core.Object,{api:api,toString:function(){return this.type},toRepr:function(){return"<"+this.type+">"},toNativeJs:function(){return this},name:name,type:name});return function(parent){return new _ObjType(parent._context)}}();return ret}});module.exports=Environment},{"./../compiler":3,"./../console":6,"./../core":13,"./../dependencies/jsface":23,"./../errors":27,"./../language":60,"./../utils":78,"./program":26}],25:[function(require,module,exports){module.exports=require("./environment")},{"./environment":24}],26:[function(require,module,exports){"use strict";var Errors=require("./../errors");var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Console=require("./../console");var Interpreter=require("./../interpreter");var Program=Class({constructor:function(compiledCode,modules,flags,outputFunc){Console.info("Created a new program instance!",modules,flags);this._interpreter=new Interpreter(flags);if(outputFunc){this._interpreter.output=outputFunc}for(var i=0;i<modules.length;++i){this._interpreter.addModule(modules[i])}if(compiledCode){this._interpreter.load(compiledCode)}},execute:function(funcName){this._interpreter.execute(funcName)},resetContext:function(){this._interpreter.resetContext()},evalRawCode:function(code){this._interpreter.eval(code);return this._interpreter.getLastValue()},_getLastValueAsVariable:function(){var ret=this._interpreter.getLastValue();return ret},getLastValue:function(){var ret=this._interpreter.getLastValue();return ret?ret.toNativeJs():ret},getGlobalVar:function(key){return this._interpreter._context.getVar(key).toNativeJs()},setGlobalVar:function(key,val,readonly){this._interpreter._context.setVar(key,val,readonly,true)},getLastError:function(){return this._interpreter.getLastError()||null},propagateExecutionErrors:function(){this._interpreter.propagateExecutionErrors()},addModule:function(moduleId,module){this._interpreter.addModule(moduleId,module)},getGlobalScopeVarNames:function(){return this._interpreter._context.getAllIdentifiers()}});module.exports=Program},{"./../console":6,"./../dependencies/jsface":23,"./../errors":27,"./../interpreter":30}],27:[function(require,module,exports){"use strict";var Console=require("./console");function addLineToError(error,line){error.message+=line!==undefined?" [at line: "+parseInt(line)+"]":"";error.line=line}function initError(err){err.expectedError=true;err.type="exception";Console.warn("Exception: ",err.message,err.stack)}function NotImplemented(){this.name="NotImplemented";this.message="You must implement this function in the child class.";this.stack=(new Error).stack;initError(this)}NotImplemented.prototype=Object.create(Error.prototype);NotImplemented.prototype.constructor=NotImplemented;function IllegalExpression(expression,reason,line){this.name="IllegalExpression";this.message="Illegal Expression ("+reason+') in "'+String(expression).substr(0,12)+'".';this.stack=(new Error).stack;addLineToError(this,line);initError(this)}IllegalExpression.prototype=Object.create(Error.prototype);IllegalExpression.prototype.constructor=IllegalExpression;function InternalError(msg,extraData){this.name="InternalError";this.message=msg;if(extraData){this.message+=" ["+extraData+"]."}this.stack=(new Error).stack;initError(this)}InternalError.prototype=Object.create(Error.prototype);InternalError.prototype.constructor=InternalError;function SyntaxError(reason,line){this.name="SyntaxError";this.message="Syntax Error ("+reason+").";this.stack=(new Error).stack;addLineToError(this,line);initError(this)}SyntaxError.prototype=Object.create(Error.prototype);SyntaxError.prototype.constructor=SyntaxError;function InterpreterError(reason,statement){this.name="InterpreterError";this.message="Interpreter Error ("+reason+").";if(statement!==undefined){this.message+=" [at statement: "+statement+"]."}this.stack=(new Error).stack;initError(this)}InterpreterError.prototype=Object.create(Error.prototype);InterpreterError.prototype.constructor=InterpreterError;function RuntimeError(reason,statement){this.name="RuntimeError";this.message="Runtime Error ("+reason+").";if(statement!==undefined){this.message+=" [at statement: "+statement+"]."}this.stack=(new Error).stack;initError(this)}RuntimeError.prototype=Object.create(Error.prototype);RuntimeError.prototype.constructor=RuntimeError;function ExceedMemoryLimit(msg){this.name="ExceedMemoryLimit";this.message=msg;this.stack=(new Error).stack;initError(this)}ExceedMemoryLimit.prototype=Object.create(Error.prototype);ExceedMemoryLimit.prototype.constructor=ExceedMemoryLimit;function StackOverflow(stackLimit){this.name="StackOverflow";this.message="Stack overflow! Stack limit: "+stackLimit+".";this.stack=(new Error).stack;initError(this)}StackOverflow.prototype=Object.create(Error.prototype);StackOverflow.prototype.constructor=StackOverflow;function ExceededStatementsLimit(limit){this.name="ExceededStatementsLimit";this.message="Script exceeded maximum statements limit of "+limit+" calls per run.";this.stack=(new Error).stack;initError(this)}ExceededStatementsLimit.prototype=Object.create(Error.prototype);ExceededStatementsLimit.prototype.constructor=ExceededStatementsLimit;function ExceededTimeLimit(limit){this.name="ExceededTimeLimit";this.message="Script exceeded execution time limit of "+limit+" MS per run.";this.stack=(new Error).stack;initError(this)}ExceededTimeLimit.prototype=Object.create(Error.prototype);ExceededTimeLimit.prototype.constructor=ExceededTimeLimit;function UndefinedVariable(key){this.name="UndefinedVariable";this.message="Undefined variable '"+key+"'!";this.stack=(new Error).stack;initError(this)}UndefinedVariable.prototype=Object.create(Error.prototype);UndefinedVariable.prototype.constructor=UndefinedVariable;module.exports={NotImplemented:NotImplemented,UndefinedVariable:UndefinedVariable,IllegalExpression:IllegalExpression,ExceededStatementsLimit:ExceededStatementsLimit,ExceededTimeLimit:ExceededTimeLimit,SyntaxError:SyntaxError,InterpreterError:InterpreterError,RuntimeError:RuntimeError,InternalError:InternalError,ExceedMemoryLimit:ExceedMemoryLimit,StackOverflow:StackOverflow}},{"./console":6}],28:[function(require,module,exports){"use strict";var adder=require("./environment");var defs=require("./defs");adder._internals={version:defs.version,Utils:require("./utils"),Compiler:require("./compiler"),Interpreter:require("./interpreter"),Core:require("./core"),Language:require("./language/index"),Lexer:require("./compiler/lexer"),Parser:require("./compiler/parser"),Adder:require("./environment"),Console:require("./console")};if(typeof window!=="undefined"){window.AdderScript=adder}module.exports=adder},{"./compiler":3,"./compiler/lexer":4,"./compiler/parser":5,"./console":6,"./core":13,"./defs":22,"./environment":25,"./interpreter":30,"./language/index":60,"./utils":78}],29:[function(require,module,exports){"use strict";module.exports={stackLimit:256,maxStatementsPerRun:2048,maxStringLen:5e3,maxContainersLen:1e3,maxVarsInScope:100,executionTimeLimit:null,memoryAllocationLimit:1e4,throwErrors:false,removeBuiltins:[]}},{}],30:[function(require,module,exports){module.exports=require("./interpreter")},{"./interpreter":31}],31:[function(require,module,exports){"use strict";var Errors=require("./../errors");var jsface=require("./../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Console=require("./../console");var defaultFlags=require("./default_flags");var Compiler=require("./../compiler");var Language=require("./../language");var Core=require("./../core");var Utils=require("./../utils");var nullConst=new Core.Variable(this._context,null);var Interpreter=Class({constructor:function(flags){this._flags=flags||{};for(var key in defaultFlags){if(this._flags[key]===undefined){this._flags[key]=defaultFlags[key]}}Console.info("Created new interpreter!");Console.log("Interpreter flags",this._flags);this._resetCurrExecutionData();this._rootBlock=null;this._context=new Core.Context(this,this._flags.stackLimit,this._flags.maxVarsInScope);this._builtins=Language.Builtins;for(var key in this._builtins.Functions){if(this._flags.removeBuiltins.indexOf(key)!==-1){continue}var val=this._builtins.Functions[key];this._addBuiltinVar(key,val)}for(key in Language.Defs.keywords){if(this._flags.removeBuiltins.indexOf(key)!==-1){continue}this._addBuiltinVar(Language.Defs.keywords[key],key)}for(var key in this._builtins.Consts){if(this._flags.removeBuiltins.indexOf(key)!==-1){continue}this._addBuiltinVar(key,this._builtins.Consts[key])}this._statementTypes={};for(var key in Language.Statements){var currStatement=Language.Statements[key];this._statementTypes[currStatement.getKeyword()]=currStatement}Console.log("Interpreter builtins:",this._context.getAllIdentifiers())},_resetCurrExecutionData:function(){this._currExecution={isDone:false,error:null,lastVal:nullConst,currStatement:null,currLine:-1,estimatedMemoryUsage:0,maxStatementsPerRun:this._flags.maxStatementsPerRun,executionTimeLimit:this._flags.executionTimeLimit,executionStartTime:this._getCurrTimeMs()}},_addBuiltinVar:function(key,val){var readonly=true;var force=true;var variable=new Core.Variable(this._context,val);this._context.setVar(key,variable,readonly,force)},addModule:function(moduleId,module){if(moduleId==="ALL"||moduleId==="SAFE"){for(var key in Language.Modules){if(moduleId==="SAFE"&&!(new Language.Modules[key]).isSafe){continue}this.addModule(key)}return}Console.log("Load module: ",moduleId);if(module===undefined){var module=Language.Modules[moduleId];if(module===undefined){throw new Errors.InterpreterError("Module '"+moduleId+"' not defined.")}}this._addBuiltinVar(moduleId,new module(this._context,"Module."+moduleId))},defineFunction:function(name,block,args){if(!block){throw new Errors.SyntaxError("Missing block for function '"+name+"'!")}var newVar=new Core.Variable(this._context,{isFunction:true,name:name,block:block,arguments:args,requiredArgs:args.length,toString:function(){return"<"+this.name+">"},toRepr:function(){return this.toString()}});this._context.setVar(name,newVar);return newVar},callFunction:function(func,args,object){if(typeof func==="string")func=this._context.getVar(func);if(func._value){func=func._value}if(!func||!func.isFunction){throw new Errors.RuntimeError("'"+func+"' is not a function!")}if(func.requiredArgs!==null&&(args.length<func.requiredArgs||args.length>func.requiredArgs+func.optionalArgs)){throw new Errors.RuntimeError("'"+func+"' expect "+func.requiredArgs+" arguments. "+args.length+" given.")}if(func.isBuiltinFunc){if(func.convertParamsToNativeJs){if(!args.map){args=[args]}args=args.map(function(x){return x&&x.toNativeJs?x.toNativeJs():x})}else{args=Core.Variable.makeAdderObjects(this._context,args)._value._list}if(object!==undefined&&!object.__isAdderObject){object=Core.Variable.makeAdderObjects(this._context,object)._value}var ret=func.__imp.apply(object!==undefined?object:this,args);this._context.getScope().returnValue=ret;this.setLastValue(ret);return ret}this._context.stackPush("function");for(var i=0;i<args.length;++i){this._context.setVar(func.arguments[i],args[i])}func.block.execute();var ret=this._context.getScope().returnValue;this.setLastValue(ret);this._context.stackPop();return ret},returnValue:function(val){var scope=this._context.getScope();scope.returnValue=val;scope.calledReturn=true},_getCurrTimeMs:function(){return Utils.getTime()},_getExecutionTime:function(){return this._getCurrTimeMs()-this._currExecution.executionStartTime},finishExecute:function(error){this._currExecution.isDone=true;this._currExecution.error=error;if(error){this._context.clearStack()}if(error&&this._flags.throwErrors){throw error}},resetContext:function(){this._context.reset()},propagateExecutionErrors:function(){if(this._currExecution.error){throw this._currExecution.error}},getLastError:function(){return this._currExecution.error},updateMemoryUsage:function(diff){this._currExecution.estimatedMemoryUsage+=diff;if(this._flags.memoryAllocationLimit&&this._currExecution.estimatedMemoryUsage>this._flags.memoryAllocationLimit){throw new Errors.ExceedMemoryLimit("Exceeded memory usage limit!")}},execute:function(funcName){if(this._rootBlock===null){throw new Errors.InterpreterError("Tried to execute code without loading any code first!")}this._resetCurrExecutionData();try{if(funcName){this.callFunction(funcName,[])}else{this._rootBlock.execute()}this.finishExecute()}catch(e){this.finishExecute(e)}},getLastValue:function(){return this._currExecution.lastVal},getLastStatement:function(){return this._currExecution.currStatement},setLastValue:function(value){if(value===undefined||value===null||value._value===null){this._currExecution.lastVal=nullConst;return}value=Core.Variable.makeVariables(this._context,value);this._currExecution.lastVal=value},evalStatement:function(statement){this.setLastValue(nullConst);this._currExecution.currLine=statement._line;this._currExecution.currStatement=statement;if(this._currExecution.maxStatementsPerRun!==null&&this._currExecution.maxStatementsPerRun--<=0){throw new Errors.ExceededStatementsLimit(this._flags.maxStatementsPerRun)}if(this._currExecution.executionTimeLimit!==null){if(this._getExecutionTime()>this._currExecution.executionTimeLimit){throw new Errors.ExceededTimeLimit(this._flags.executionTimeLimit)}}try{var ret=statement.execute();this.setLastValue(ret)}catch(e){if(e.message&&this._currExecution.currLine&&e.line===undefined){e.message+=" [at line: "+this._currExecution.currLine+"]";e.line=true}throw e}},eval:function(code){var compiler=new Compiler(this._flags);var compiled=compiler.compile(code);this.load(compiled);this.execute()},__parseStatement:function(ast,line){var statementType=this._statementTypes[ast[0].value];statementType=statementType||this._statementTypes[""];var currStatement=new statementType(this._context,ast,line);return currStatement},load:function(compiledCode){Console.debug("Loading code..",compiledCode);var context=this._context;var globalBlock=new Core.Block(context);var blocksQueue=[globalBlock];var currBlock=globalBlock;var lastStatement={openNewBlock:false};for(var i=0;i<compiledCode.length;++i){var currAst=compiledCode[i][0];var line=compiledCode[i][1];var openedNewBlock=false;if(currAst==="NEW_BLOCK"){var newBlock=new Core.Block(context);currBlock.addBlock(newBlock);blocksQueue.push(newBlock);openedNewBlock=true;continue}if(currAst==="END_BLOCK"){blocksQueue.pop();if(blocksQueue.length===0){throw new Errors.InternalError("Invalid END_BLOCK token, ran out of blocks!")}continue}if(lastStatement.OpenNewBlock&&!openedNewBlock){throw new Errors.SyntaxError("Missing block indent.",line)}else if(!lastStatement.OpenNewBlock&&openedNewBlock){throw new Errors.SyntaxError("Unexpected block indent.",line)}if(currAst.length===0){continue}var statement=this.__parseStatement(currAst,line);currBlock=blocksQueue[blocksQueue.length-1];var lastStatementInBlock=currBlock._lastStatement;statement.setPreviousStatement(lastStatementInBlock);currBlock.addStatement(statement);lastStatement=statement}this._rootBlock=globalBlock;Console.debug("Code loaded successfully!")},getDebugBlocksView:function(){return this._rootBlock.getDebugBlocksView(0)},output:function(){console.log.apply(null,arguments)}});module.exports=Interpreter},{"./../compiler":3,"./../console":6,"./../core":13,"./../dependencies/jsface":23,"./../errors":27,"./../language":60,"./../utils":78,"./default_flags":29}],32:[function(require,module,exports){"use strict";var generalDefs=require("./../../defs");var consts={__VERSION__:generalDefs.version,__ABOUT__:generalDefs.about,True:true,False:false,None:null,NaN:NaN};module.exports=consts},{"./../../defs":22}],33:[function(require,module,exports){"use strict";var defs={charsLegalInVarName:["_","$"],keywords:{def:"def",pass:"pass",return:"return",for:"for",while:"while",continue:"continue",break:"break",if:"if",else:"else",elif:"elif",true:"True",false:"False",null:"None",NaN:"NaN",not:"not",in:"in",or:"or",and:"and",is:"is"}};module.exports=defs},{}],34:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(){for(var i=0;i<arguments.length;++i){if(!arguments[i]._value){return false}}return true},null,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],35:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Any=Class(Core.BuiltinFunc,{__imp:function(args){for(var i=0;i<args.length;++i){if(args[i]._value)return true}return false},requiredArgs:null});module.exports=Core.BuiltinFunc.create(function(){for(var i=0;i<arguments.length;++i){if(arguments[i]._value){return true}}return false},null,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],36:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return(val._value>>>0).toString(2)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],37:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return Boolean(val._value)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],38:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){var val=val._value;return Boolean(val&&val.isFunction)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],39:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return String.fromCharCode(val._value)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],40:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");function getNumericVal(x){if(typeof x==="string"){var ret=0;for(var i=0;i<x.length;i++){ret+=x.charCodeAt(i)}return ret}return parseFloat(x)}module.exports=Core.BuiltinFunc.create(function(a,b){return getNumericVal(a._value)-getNumericVal(b._value)},2,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],41:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(variable){if(variable&&variable.deleteSelf){return variable.deleteSelf()}throw new Errors.RuntimeError("Invalid object to delete!")},1,0,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],42:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Utils=require("./../../utils");module.exports=Core.BuiltinFunc.create(function(){return new Core.Dict(this._context)},0,0,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],43:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(obj){if(obj){var val=obj._value;if(val&&val.api){return Object.keys(val.api)}throw new Errors.RuntimeError("'"+obj.type+"' Is not a valid object type for dir().")}return this._context.getAllIdentifiers()},0,1,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],44:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(a,b){return Core.Variable.equal(a,b)},2,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],45:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(variable){return this._context.exist(variable._value)},1,0,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],46:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return parseFloat(val._value)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],47:[function(require,module,exports){"use strict";var functions={print:require("./print"),all:require("./all"),any:require("./any"),bin:require("./bin"),bool:require("./bool"),callable:require("./callable"),chr:require("./chr"),cmp:require("./cmp"),float:require("./float"),int:require("./int"),len:require("./len"),ord:require("./ord"),range:require("./range"),str:require("./str"),repr:require("./repr"),type:require("./type"),list:require("./list"),set:require("./set"),dict:require("./dict"),reversed:require("./reversed"),equal:require("./equal"),dir:require("./dir"),delete:require("./delete"),exist:require("./exist"),_sec_test:require("./test")};for(var key in functions){functions[key].identifier="builtin.functions."+key}module.exports=functions},{"./all":34,"./any":35,"./bin":36,"./bool":37,"./callable":38,"./chr":39,"./cmp":40,"./delete":41,"./dict":42,"./dir":43,"./equal":44,"./exist":45,"./float":46,"./int":48,"./len":49,"./list":50,"./ord":51,"./print":52,"./range":53,"./repr":54,"./reversed":55,"./set":56,"./str":57,"./test":58,"./type":59}],48:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val,base){return parseInt(val._value,base?base._value:undefined)},1,1)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],49:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){var val=val._value;if(val){if(val.api&&val.len){return val.len()}if(val.length!==undefined){return val.length}}return null},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],50:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Utils=require("./../../utils");module.exports=Core.BuiltinFunc.create(function(){return new Core.List(this._context,Utils.toArray(arguments))},null,null,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],51:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){var str=val._value;if(typeof str!=="string"){throw new Errors.RuntimeError("'ord()' expect a string as parameter (called with '"+typeof str+"').")}if(str.length!==1){throw new Errors.RuntimeError("'ord()' expect string with length of 1 (called with length '"+str.length+"').")}return str.charCodeAt(0)},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],52:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Utils=require("./../../utils");module.exports=Core.BuiltinFunc.create(function(){var args=Utils.toArray(arguments);args=args.map(function(x){return x.toString()});this._context._interpreter.output.apply(this._context._interpreter,args)},0,100)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],53:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(start,stop,step){if(stop===undefined&&step===undefined){stop=start._value;start=0;step=1}else{start=start._value;stop=stop._value;step=step?step._value:1}if(typeof start!=="number"||typeof stop!=="number"||typeof step!=="number"){throw new Errors.RuntimeError("Illegal arguments!")}if(step===0){return new Core.List(this._context,[])}if(step>0&&stop<start){return new Core.List(this._context,[])}if(step<0&&stop>start){return new Core.List(this._context,[])}var ret=[];var curr=start;while(!(isNaN(curr)||step>0&&curr>=stop||step<0&&curr<=stop||ret.length>=1e5)){ret.push(curr);curr+=step}return new Core.List(this._context,ret)},1,2)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],54:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return val.toRepr()},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],55:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){if(val.type!=="list"){throw new Errors.RuntimeError("'reversed()' expecting a list as param ("+val.type+" given).")}var ret=val._value.clone();ret.reverse();return ret},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],56:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Utils=require("./../../utils");module.exports=Core.BuiltinFunc.create(function(){return new Core.Set(this._context,Utils.toArray(arguments))},null,null,false)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],57:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return val.toString()},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],58:[function(require,module,exports){(function(global){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Utils=require("./../../utils");module.exports=Core.BuiltinFunc.create(function(args){args=Utils.toArray(arguments);var _window=typeof window==="undefined"?global:window;if(_window.__adder_script_test){return _window.__adder_script_test.apply(null,args)}return args},null,null)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],59:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");module.exports=Core.BuiltinFunc.create(function(val){return val.getType()},1,null)},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],60:[function(require,module,exports){"use strict";var language={Statements:require("./statements"),Defs:require("./defs"),Modules:require("./modules"),Builtins:{Functions:require("./functions"),Consts:require("./consts")}};module.exports=language},{"./consts":32,"./defs":33,"./functions":47,"./modules":62,"./statements":74}],61:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var Alert=Core.BuiltinFunc.create(function(val){if(typeof alert==="undefined"){return console.log(val._value)}return alert(val._value)},1,0,false);var AlertModule=Class(Core.Module,{api:{alert:Alert},isSafe:false,name:"Alert",version:"1.0.0"});module.exports=AlertModule},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],62:[function(require,module,exports){"use strict";module.exports={Math:require("./math"),Input:require("./input"),Alert:require("./alert"),Random:require("./random")}},{"./alert":61,"./input":63,"./math":64,"./random":65}],63:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var RawInput=Core.BuiltinFunc.create(function(text,defval){if(typeof prompt==="undefined"){throw new Errors.RuntimeError("rawInput not supported on this platform!")}return window.prompt(text._value,defval?defval._value:"")},1,1,false);var Input=Class(Core.Module,{api:{rawInput:RawInput},isSafe:false,name:"Input",version:"1.0.0"});module.exports=Input},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],64:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Utils=require("./../../utils");var Core=require("./../../core");var Abs=Core.BuiltinFunc.create(function(val){return Math.abs(val._value)},1,0,true);var Max=Core.BuiltinFunc.create(function(){var args=Core.BuiltinFunc.getArgumentsOrListContent(this._context,arguments);return Math.max.apply(null,Utils.toArray(args).map(function(x){return x._value}))},1,100,true);var Min=Core.BuiltinFunc.create(function(val){var args=Core.BuiltinFunc.getArgumentsOrListContent(this._context,arguments);return Math.min.apply(null,Utils.toArray(args).map(function(x){return x._value}))},1,100,true);var Pow=Core.BuiltinFunc.create(function(val,pow){return Math.pow(val._value,pow?pow._value:undefined)},1,1,true);var Round=Core.BuiltinFunc.create(function(val){return Math.round(val._value)},1,0,true);var Floor=Core.BuiltinFunc.create(function(val){return Math.floor(val._value)},1,0,true);var Ceil=Core.BuiltinFunc.create(function(val){return Math.ceil(val._value)},1,0,true);var Cos=Core.BuiltinFunc.create(function(val){return Math.cos(val._value)},1,0,true);var Sin=Core.BuiltinFunc.create(function(val){return Math.sin(val._value)},1,0,true);var Atan=Core.BuiltinFunc.create(function(val){return Math.atan(val._value)},1,0,true);var Exp=Core.BuiltinFunc.create(function(val){return Math.exp(val._value)},1,0,true);var Tan=Core.BuiltinFunc.create(function(val){return Math.tan(val._value)},1,0,true);var Log=Core.BuiltinFunc.create(function(val){return Math.log(val._value)},1,0,true);var Sqrt=Core.BuiltinFunc.create(function(val){return Math.sqrt(val._value)},1,0,true);var Sign=Core.BuiltinFunc.create(function(val){if(Math.sign){return Math.sign(val._value)}return val._value<0?-1:val._value>0?1:0},1,0,true);var Sum=Core.BuiltinFunc.create(function(){var args=Core.BuiltinFunc.getArgumentsOrListContent(this._context,arguments);var ret=0;for(var i=0;i<args.length;++i){ret+=parseFloat(args[i]._value)}return ret},null,null,true);var Mul=Core.BuiltinFunc.create(function(){var args=Core.BuiltinFunc.getArgumentsOrListContent(this._context,arguments);var ret=1;for(var i=0;i<args.length;++i){ret*=parseFloat(args[i]._value)}return ret},null,null,true);var E=Math.E;var PI=Math.PI;var SQRT2=Math.SQRT2;var MathModule=Class(Core.Module,{api:{abs:Abs,min:Min,max:Max,pow:Pow,round:Round,floor:Floor,ceil:Ceil,cos:Cos,sin:Sin,atan:Atan,exp:Exp,tan:Tan,log:Log,sqrt:Sqrt,sign:Sign,sum:Sum,mul:Mul,E:E,PI:PI,SQRT2:SQRT2},isSafe:true,name:"Math",version:"1.0.0"});module.exports=MathModule},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],65:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Utils=require("./../../utils");var Core=require("./../../core");var Rand=Core.BuiltinFunc.create(function(){return Math.random()},0,0,false);var RandInt=Core.BuiltinFunc.create(function(min,max){if(max===undefined){return Math.round(Math.random()*min._value)}return min._value+Math.round(Math.random()*(max._value-min._value))},1,1,false);var RandFloat=Core.BuiltinFunc.create(function(min,max){if(max===undefined){return Math.random()*min._value}return min._value+Math.random()*(max._value-min._value)},1,1,false);var Select=Core.BuiltinFunc.create(function(selection){var list=undefined;if(selection.type==="dict"){list=Object.keys(selection._value._dict)}if(selection.type==="list"){list=selection._value._list}if(selection.type==="set"){list=Utils.toArray(selection._value._set)}if(list===undefined){throw new Errors.RuntimeError("Object '"+selection.type+"' does not support random selection.")}var val=list[Math.floor(Math.random()*list.length)];return val&&val.getValue?val.getValue():val},1,0,false);var BooleanRand=Core.BuiltinFunc.create(function(){return Math.random()<.5?false:true},0,0,false);var BinaryRand=Core.BuiltinFunc.create(function(){return Math.round(Math.random())},0,0,false);var RandomModule=Class(Core.Module,{api:{rand:Rand,rand_int:RandInt,rand_float:RandFloat,select:Select,boolean:BooleanRand,binary:BinaryRand},isSafe:true,name:"Random",version:"1.0.0"});module.exports=RandomModule},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../../utils":78}],66:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Break=Class(Core.Statement,{constructor:function(context,ast,line){Break.$super.call(this,context,line);if(ast.length!==1){throw new Errors.SyntaxError("Illegal expression after 'break' statement!",line)}},execute:function(){var blockType=this._context.getCurrBlockType();if(blockType!=="loop"){throw new Errors.RuntimeError("'break' outside loop!")}var scope=this._context.getScope();scope.calledContinue=true;scope.calledBreak=true},$static:{getKeyword:function(){return keywords["break"]}},openNewBlock:false});module.exports=Break},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],67:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Continue=Class(Core.Statement,{constructor:function(context,ast,line){Continue.$super.call(this,context,line);if(ast.length!==1){throw new Errors.SyntaxError("Illegal expression after 'continue' statement!",line)}},execute:function(){if(this._context.getCurrBlockType()!=="loop"){throw new Errors.RuntimeError("'continue' outside loop!")}this._context.getScope().calledContinue=true},$static:{getKeyword:function(){return keywords["continue"]}},openNewBlock:false});module.exports=Continue},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],68:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Def=Class(Core.Statement,{constructor:function(context,ast,line){Def.$super.call(this,context,line);if(ast.length<3){throw new Errors.SyntaxError("Incomplete function def line",line)}if(ast[1].type!=="call"){throw new Errors.SyntaxError("Expecting parenthesis and arguments list after function name.",line)}if(ast[2].type!=="blockopen"){throw new Errors.SyntaxError("Expecting colon after function arguments list.",line)}var funcData=ast[1];this._name=funcData.name;this._args=[];for(var i=0;i<funcData.args.length;++i){var argData=funcData.args[i];if(argData.type!=="identifier"){throw new Errors.SyntaxError("Unexpected token '"+argData.value+"' in function arguments list.",line)}this._args.push(argData.value)}},$static:{getKeyword:function(){return keywords["def"]}},execute:function(){return this._context._interpreter.defineFunction(this._name,this._followingBlock,this._args)},openNewBlock:true,skipFollowingBlock:true});module.exports=Def},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],69:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Elif=Class(Core.Statement,{constructor:function(context,ast,line){Elif.$super.call(this,context,line);if(ast.length<3){throw new Errors.SyntaxError("Incomplete 'elif' statement!",line)}if(ast[2].value!==":"){throw new Errors.SyntaxError("Missing colon after 'elif' statement!",line)}this._condition=new Core.Expression(this._context,ast[1])},$static:{getKeyword:function(){return keywords["elif"]}},setPreviousStatement:function(statement){if(!statement||!statement.isIfStatement){throw new Errors.SyntaxError("'elif' statement not after 'if'!")}this._prevStatement=statement},execute:function(){if(this._prevStatement._conditionMet){return}this._conditionMet=Boolean(this._condition.eval());if(!this._conditionMet){return}if(this._followingBlock){this._followingBlock.execute()}},isIfStatement:true,openNewBlock:true,skipFollowingBlock:true});module.exports=Elif},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],70:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Else=Class(Core.Statement,{constructor:function(context,ast,line){Else.$super.call(this,context,line);if(ast[1].value!==":"){throw new Errors.SyntaxError("Missing colon after 'else' statement!",line)}},$static:{getKeyword:function(){return keywords["else"]}},setPreviousStatement:function(statement){if(!statement||!statement.isIfStatement){throw new Errors.SyntaxError("'else' statement not after 'if'!")}this._prevStatement=statement},execute:function(){if(this._prevStatement._conditionMet){return}if(this._followingBlock){this._followingBlock.execute()}},openNewBlock:true,skipFollowingBlock:true});module.exports=Else},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],71:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var EvaluateExpression=Class(Core.Statement,{constructor:function(context,ast,line){EvaluateExpression.$super.call(this,context,line);if(ast.length!=1){throw new Errors.SyntaxError("Invalid expression!",line)}this._expression=ast[0]},$static:{getKeyword:function(){return""}},getRepr:function(){return"exp "+(this._expression._ast?this._expression._ast.type:this._expression.type)},execute:function(){if(this._expression.constructor!==Core.Expression){this._expression=new Core.Expression(this._context,this._expression)}return this._expression.eval()},openNewBlock:false});module.exports=EvaluateExpression},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27}],72:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var For=Class(Core.Statement,{constructor:function(context,ast,line){For.$super.call(this,context,line);if(!ast[1]||ast[1].type!=="in"){throw new Errors.SyntaxError("Expecting 'in' operator after for identifier.",line)}if(!ast[1]||ast[1].left.type!=="identifier"){throw new Errors.SyntaxError("Expecting variable name after 'for' statement.",line)}if(ast.length<3){throw new Errors.SyntaxError("Incomplete 'for' statement!",line)}if(ast[ast.length-1].value!==":"){throw new Errors.SyntaxError("Missing colon after 'for' statement!",line)}this._target=new Core.Expression(this._context,ast[1].right);this.identifier=ast[1].left.value},$static:{getKeyword:function(){return keywords["for"]}},execute:function(){var target=this._target.eval();if(!target||!target.forEach&&target.length===undefined){throw new Errors.RuntimeError("Object type '"+typeof target+"' does not support iteration!")}this._context.stackPush("loop");try{if(target.forEach){target.forEach(this._execBlock,this)}else{for(var i=0;i<target.length;++i){if(this._execBlock(target[i])===false){break}}}}catch(e){this._context.stackPop();throw e}this._context.stackPop()},_execBlock:function(val){var scope=this._context.getScope();if(scope.calledBreak||scope.calledReturn){return false}this._context.setVar(this.identifier,val);if(this._followingBlock){this._followingBlock.execute()}scope.calledContinue=false;return true},openNewBlock:true,skipFollowingBlock:true});module.exports=For},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],73:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var If=Class(Core.Statement,{constructor:function(context,ast,line){If.$super.call(this,context,line);if(ast.length<3){throw new Errors.SyntaxError("Incomplete 'if' statement!",line)}if(ast[2].value!==":"){throw new Errors.SyntaxError("Missing colon after 'if' statement!",line)}this._condition=new Core.Expression(this._context,ast[1])},$static:{getKeyword:function(){return keywords["if"]}},execute:function(){this._conditionMet=Boolean(this._condition.eval());if(!this._conditionMet){return}if(this._followingBlock){this._followingBlock.execute()}},isIfStatement:true,openNewBlock:true,skipFollowingBlock:true});module.exports=If},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],74:[function(require,module,exports){"use strict";var statements={pass:require("./pass"),def:require("./def"),return:require("./return"),for:require("./for"),while:require("./while"),continue:require("./continue"),break:require("./break"),if:require("./if"),else:require("./else"),elif:require("./elif"),"!@#$%^&*()_default":require("./evaluate_expression")};for(var key in statements){statements[key].prototype.identifier="builtin.statements."+key}module.exports=statements},{"./break":66,"./continue":67,"./def":68,"./elif":69,"./else":70,"./evaluate_expression":71,"./for":72,"./if":73,"./pass":75,"./return":76,"./while":77}],75:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Pass=Class(Core.Statement,{constructor:function(context,ast,line){Pass.$super.call(this,context,line);if(ast.length!==1){throw new Errors.SyntaxError("Illegal expression after pass statement!",line)}},execute:function(){return null},$static:{getKeyword:function(){return keywords["pass"]}},openNewBlock:false});module.exports=Pass},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],76:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var Return=Class(Core.Statement,{constructor:function(context,ast,line){Return.$super.call(this,context,line);this._retExpression=ast[1];if(ast.length>2){throw new Errors.SyntaxError("Illegal return expression!",line)}},$static:{getKeyword:function(){return keywords["return"]}},execute:function(){var retVal=null;if(this._retExpression){if(this._retExpression.constructor!==Core.Expression){this._retExpression=new Core.Expression(this._context,this._retExpression)}retVal=this._retExpression.eval()}this._context._interpreter.returnValue(retVal);return retVal},openNewBlock:false});module.exports=Return},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],77:[function(require,module,exports){"use strict";var jsface=require("./../../dependencies/jsface"),Class=jsface.Class,extend=jsface.extend;var Errors=require("./../../errors");var Core=require("./../../core");var LanguageDefs=require("./../defs");var keywords=LanguageDefs.keywords;var While=Class(Core.Statement,{constructor:function(context,ast,line){While.$super.call(this,context,line);if(ast.length!==3){throw new Errors.SyntaxError("Invalid 'while' statement!",line)}if(ast[ast.length-1].value!==":"){throw new Errors.SyntaxError("Missing colon after 'while' statement!",line)}this._condition=new Core.Expression(this._context,ast[1])},$static:{getKeyword:function(){return keywords["while"]}},execute:function(){var conditionResult=this._condition.eval();if(!conditionResult||!this._followingBlock){return}var maxAttemptsLeft=1e7;this._context.stackPush("loop");try{while(maxAttemptsLeft--){this._followingBlock.execute();var scope=this._context.getScope();if(scope.calledBreak||scope.calledReturn){break}scope.calledContinue=false;if(!this._condition.eval()){break}}}catch(e){this._context.stackPop();throw e}this._context.stackPop()},_execBlock:function(val){if(this._context.getScope().calledBreak){return false}this._context.setVar(this.identifier,val);if(this._followingBlock){this._followingBlock.execute()}this._context.getScope().calledContinue=false;return true},openNewBlock:true,skipFollowingBlock:true});module.exports=While},{"./../../core":13,"./../../dependencies/jsface":23,"./../../errors":27,"./../defs":33}],78:[function(require,module,exports){"use strict";var Errors=require("./errors");function toArray(x){if(Array.from){return Array.from(x)}if(x.length!==undefined){return Array.prototype.slice.call(x)}var ret=[];if(x.forEach){x.forEach(function(item){ret.push(item)});return ret}throw new Errors.InternalError("Cannot convert object "+typeof x+" to array!")}function toSet(values){var ret=new Set(values);if(values&&values.length!==ret.size){for(var i=0;i<values.length;++i){ret.add(values[i])}}return ret}var performance=typeof performance!=="undefined"?performance:Date;function getTime(){return performance.now()}function replaceAll(text,search,replacement){return text.split(search).join(replacement)}module.exports={toArray:toArray,toSet:toSet,getTime:getTime,replaceAll:replaceAll}},{"./errors":27}]},{},[28])(28)});